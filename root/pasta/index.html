#!/bin/sh -e
PASTE_BIN=pasta
echo method: $REQUEST_METHOD 1>&2

printf '\n'
case "$REQUEST_METHOD" in
	GET)
		ARGV0=$(realpath "$0")
		ls -t "${ARGV0%/*}" | grep -v "$0";;
	POST)
		code="$(tr -dc '[:alnum:]' < /dev/urandom | head -c3)"
		echo "$code"
		# 50MB max(?)
		cat | head -c 50000000 > "${PASTE_BIN}/$code";;
	*) exit 1
esac
